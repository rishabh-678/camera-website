"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99192],{43367:function(n,t,e){e.d(t,{xo:function(){return P},Wo:function(){return x},zK:function(){return A},Sj:function(){return N},sh:function(){return E},BL:function(){return Z},P4:function(){return k},Gz:function(){return j},uQ:function(){return S},Rm:function(){return w}});var r,o=e(94713),i=e(5338),c=e(6939),a=e(30073),u=e.n(a),l=e(91341),s=e(10086),p=e(23810),f=e(75893);e(39010);var v=e(75976);function d(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function g(n,t){var e=t.matcher,r=t.mutator,i=t.options,c=t.revalidate;if(e){if("function"==typeof e)a=function(t){var r=Array.isArray(t)?t:[null];return(0,p.Z)(r,1)[0]===n.tag&&e(t)};else{var a,u,l,s=Array.isArray(e)?e:[e,null!==(u=null===(l=n.pagination)||void 0===l?void 0:l.initial)&&void 0!==u?u:void 0],g=(0,p.Z)(s,2),y=g[0],m=g[1];if(n.tag.startsWith("api-")){var b=(0,v.Qd)(n,y,m);a=function(n){return Array.isArray(n)&&b.every(function(t,e){return n[e]===t})}}else{var O=(0,v.Qd)(n,y,m,0).slice(0,-1);a=function(n){return Array.isArray(n)&&O.every(function(t,e){return n[e]===t})}}}}else a=function(t){var e=Array.isArray(t)?t:[null];return(0,p.Z)(e,1)[0]===n.tag};(0,f.JG)(a,"function"==typeof r?function(n){return n&&r(n)}:function(){return r},function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?d(Object(e),!0).forEach(function(t){(0,o.Z)(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}({revalidate:void 0!==c&&c},i)).catch(Sentry.captureException)}var y=e(54184),m=e(69566),b=e(23194);function O(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function h(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?O(Object(e),!0).forEach(function(t){(0,o.Z)(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):O(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}var j=(0,s.xk)(function(n){return"/api/v2/me/collections/medium/".concat(n.id)},(0,s.Nv)()),P=(0,s.H$)(function(n){var t=n.collection,e=n.medium;return["POST","/api/v2/collections/".concat((0,y.j)(t),"/photos").concat(e&&"?photo_id=".concat((0,y.j)(e))),null]},(0,s.Nv)(),{onSuccess:function(n){var t=n.collection,e=n.medium;(0,l.Z)({name:"collection",action:"add",id:(0,y.j)(t)}),g(b.Mk,{}),g(j,{matcher:e,mutator:function(n){return{data:[].concat((0,c.Z)(n.data),[(0,y.j)(t)])}}})}}),w=(0,s.H$)(function(n){return["PATCH","/api/v2/collections/".concat((0,y.j)(n)),n.attributes]},(0,s.Nv)(),{onSuccess:function(n){(0,l.Z)({name:"collection",action:"update",id:(0,y.j)(n)}),g(b.Mk,{})}}),k=(0,s.H$)(function(n){return["DELETE","/api/v2/collections/".concat(n),null]},(0,s.Nv)(),{onSuccess:function(n){(0,l.Z)({name:"collection",action:"delete",id:n}),g(b.Mk,{}),g(j,{mutator:function(t){return{data:t.data.filter(function(t){return t!==n})}}})}}),S=(0,s.H$)(function(n){var t=n.collection,e=n.medium;return["DELETE","/api/v2/collections/".concat((0,y.j)(t),"/photos").concat(e?"?photo_id=".concat((0,y.j)(e)):"/"),null]},(0,s.Nv)(),{onSuccess:function(n){var t=n.collection,e=n.medium;(0,l.Z)({name:"collection",action:"remove",id:(0,y.j)(t)}),g(b.Mk,{}),g(j,{matcher:e,mutator:function(n){return{data:n.data.filter(function(n){return n!==(0,y.j)(t)})}}})}}),Z=(0,s.H$)(function(n){return["POST","/api/v2/collections?title=".concat(n),null]},(0,s.Nv)(),{onSuccess:(r=(0,i.Z)(u().mark(function n(t,e){var r;return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=e.data,(0,l.Z)({name:"collection",action:"create",id:r.id});case 2:case"end":return n.stop()}},n)})),function(n,t){return r.apply(this,arguments)})}),x=(0,s.xk)(function(n){return"/api/v2/collections/".concat(n)},(0,s.Nv)()),E=(0,s.EP)()(function(n,t){var e=t.page;return"/api/v2/collections?".concat((0,m.Pz)({per_page:12,page:e}))}),N=(0,s.xk)(function(n){return"/api/v3/collections/".concat(n,"/tags")},(0,s.Nv)());(0,s.xk)(function(){return"/api/v3/collections/popular"},(0,s.Nv)()),(0,s.xk)(function(n){return"/api/v3/search/collection?".concat((0,m.Pz)(n))},(0,s.Nv)()),(0,s.EP)()(function(n,t){var e=t.page;return"/api/v3/collections/suggestions?".concat((0,m.Pz)(h(h({},n),{},{page:e})))});var A=(0,s.EP)()(function(n,t){var e=t.page;return"/api/v3/collections/".concat(n,"/media?page=").concat(e,"&per_page=12")})},17700:function(n,t,e){e.d(t,{Y:function(){return v}});var r=e(5338),o=e(23810),i=e(6939),c=e(30073),a=e.n(c),u=e(18529),l=e(39010),s=e(75976),p=e(86126),f={parallel:!0,revalidateFirstPage:!1,revalidateAll:!1};function v(n,t,e,c){var v,d=(0,u.useRef)(void 0),g=(0,u.useMemo)(function(){var r=(null!==(v=n.pagination)&&void 0!==v?v:{}).initPageState,i=(0,p.o)(n,e,c,t,!0,f),a=(0,o.Z)(i,3),u=a[0],l=a[1],s=a[2];if(r){var v,g,y=null!==(g=null==t?void 0:t.pagination)&&void 0!==g?g:null;d.current=r(y,s)}return{initialUrl:l,swrOpts:u}},[]),y=(0,u.useState)(function(){var e;return t?null===(e=n.meta)||void 0===e?void 0:e.call(n,t):void 0}),m=y[0],b=y[1],O=(0,u.useCallback)(function(t){var r,o,i,a=null!==(r=null===(o=n.pagination)||void 0===o?void 0:o.getPageState(d.current,t))&&void 0!==r?r:null===(i=n.pagination)||void 0===i?void 0:i.initial;return(null==c?void 0:c.enabled)===!1?null:(0,s.Qd)(n,e,a,t)},[n,e,null==c?void 0:c.enabled]),h=(0,u.useCallback)((v=(0,r.Z)(a().mark(function t(e){var r,i,c,u,l;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=(0,o.Z)(e,5)[4],t.next=3,n.queryFn(e,"response");case 3:return c=t.sent,u=(0,p.y)(n.select,c),c&&null!==(r=n.pagination)&&void 0!==r&&r.updateState&&void 0!==(l=n.pagination.updateState(c.pagination,d.current,i))&&(d.current=l),n.meta&&c&&b(function(t){var e,r;return null!==(e=null===(r=n.meta)||void 0===r?void 0:r.call(n,c))&&void 0!==e?e:t}),t.abrupt("return",u);case 8:case"end":return t.stop()}},t)})),function(n){return v.apply(this,arguments)}),[n]),j=(0,l.ZP)(O,h,g.swrOpts),P=j.data,w=j.isLoading,k=j.isValidating,S=j.size,Z=j.mutate,x=j.setSize,E=(0,u.useMemo)(function(){var n;return null!==(n=null==P?void 0:P.reduce(function(n,t){return n.push.apply(n,(0,i.Z)(t)),n},[]))&&void 0!==n?n:[]},[P]);return(0,u.useMemo)(function(){var t,e,o,i;return{data:E,meta:m,isLoading:w,isFetching:w||k,queryKey:g.initialUrl,hasNextPage:null!==(t=null===(e=n.pagination)||void 0===e?void 0:e.hasNextPage(d.current,S))&&void 0!==t&&t,getResultCount:function(){var t,e;return null!==(t=null===(e=n.pagination)||void 0===e?void 0:e.getResultCount(d.current))&&void 0!==t?t:null},refetch:(o=(0,r.Z)(a().mark(function n(){return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Z();case 2:return n.abrupt("return",null);case 3:case"end":return n.stop()}},n)})),function(){return o.apply(this,arguments)}),fetchNextPage:(i=(0,r.Z)(a().mark(function n(){var t;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return x(t=S+1),n.abrupt("return",t);case 3:case"end":return n.stop()}},n)})),function(){return i.apply(this,arguments)})}},[E,m,w,k,g,n.pagination,Z,S,x])}}}]);